"0","calcError = "
"0","function(estXY, actualXY) "
"0","   sum( rowSums( (estXY - actualXY)^2) )"
"0","actualXY = onlineSummary[ , c(""posX"", ""posY"")]"
"0","sapply(list(estXYk1, estXYk3), calcError, actualXY)"
"1","[1]"
"1"," 659"
"1"," 307"
"1","
"
"0","v = 11"
"0","permuteLocs = sample(unique(offlineSummary$posXY))"
"0","permuteLocs = matrix(permuteLocs, ncol = v, "
"0","                     nrow = floor(length(permuteLocs)/v))"
"2","data length [166] is not a sub-multiple or multiple of the number of rows [15]"
"0","onlineFold = subset(offlineSummary, posXY %in% permuteLocs[ , 1])"
"0","reshapeSS = function(data, varSignal = ""signal"", "
"0","                     keepVars = c(""posXY"", ""posX"",""posY""),"
"0","                     sampleAngle = FALSE, "
"0","                     refs = seq(0, 315, by = 45)) {"
"0","  byLocation ="
"0","    with(data, by(data, list(posXY), "
"0","                  function(x) {"
"0","                    if (sampleAngle) {"
"0","                      x = x[x$angle == sample(refs, size = 1), ]}"
"0","                    ans = x[1, keepVars]"
"0","                    avgSS = tapply(x[ , varSignal ], x$mac, mean)"
"0","                    y = matrix(avgSS, nrow = 1, ncol = 6,"
"0","                               dimnames = list(ans$posXY,"
"0","                                               names(avgSS)))"
"0","                    cbind(ans, y)"
"0","                  }))"
"0","  newDataSS = do.call(""rbind"", byLocation)"
"0","  return(newDataSS)"
"0","}"
"0","offline = offline[ offline$mac != ""00:0f:a3:39:dd:cd"", ]"
"0","keepVars = c(""posXY"", ""posX"",""posY"", ""orientation"", ""angle"")"
"0","onlineCVSummary = reshapeSS(offline, keepVars = keepVars, "
"0","                            sampleAngle = TRUE)"
"0","onlineFold = subset(onlineCVSummary, "
"0","                    posXY %in% permuteLocs[ , 1])"
"0","offlineFold = subset(offlineSummary,"
"0","                     posXY %in% permuteLocs[ , -1])"
"0","estFold = predXY(newSignals = onlineFold[ , 6:11], "
"0","                 newAngles = onlineFold[ , 4], "
"0","                 offlineFold, numAngles = 3, k = 3)"
"0","actualFold = onlineFold[ , c(""posX"", ""posY"")]"
"0","calcError(estFold, actualFold)"
"1","[1]"
"1"," 163"
"1","
"
"0","K = 20"
"0","err = rep(0, K)"
"0","for (j in 1:v) {"
"0","  onlineFold = subset(onlineCVSummary, "
"0","                      posXY %in% permuteLocs[ , j])"
"0","  offlineFold = subset(offlineSummary,"
"0","                       posXY %in% permuteLocs[ , -j])"
"0","  actualFold = onlineFold[ , c(""posX"", ""posY"")]"
"0","  "
"0","  for (k in 1:K) {"
"0","    estFold = predXY(newSignals = onlineFold[ , 6:11],"
"0","                     newAngles = onlineFold[ , 4], "
"0","                     offlineFold, numAngles = 3, k = k)"
"0","    err[k] = err[k] + calcError(estFold, actualFold)"
"0","  }"
"0","}"
"0","pdf(file = ""Geo_CVChoiceOfK.pdf"", width = 10, height = 6)"
