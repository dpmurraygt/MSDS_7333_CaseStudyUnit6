"0","length(train130[[1]])"
"1","[1]"
"1"," 166"
"1","
"
"0","findNN = function(newSignal, trainSubset) {"
"0","  diffs = apply(trainSubset[ , 4:9], 1, "
"0","                function(x) x - newSignal)"
"0","  dists = apply(diffs, 2, function(x) sqrt(sum(x^2)) )"
"0","  closest = order(dists)"
"0","  return(trainSubset[closest, 1:3 ])"
"0","}"
"0","predXY = function(newSignals, newAngles, trainData, "
"0","                  numAngles = 1, k = 3){"
"0","  "
"0","  closeXY = list(length = nrow(newSignals))"
"0","  "
"0","  for (i in 1:nrow(newSignals)) {"
"0","    trainSS = selectTrain(newAngles[i], trainData, m = numAngles)"
"0","    closeXY[[i]] = "
"0","      findNN(newSignal = as.numeric(newSignals[i, ]), trainSS)"
"0","  }"
"0","  estXY = lapply(closeXY, "
"0","                 function(x) sapply(x[ , 2:3], "
"0","                                    function(x) mean(x[1:k])))"
"0","  estXY = do.call(""rbind"", estXY)"
"0","  return(estXY)"
"0","}"
"0","estXYk3 = predXY(newSignals = onlineSummary[ , 6:11], "
"0","                 newAngles = onlineSummary[ , 4], "
"0","                 offlineSummary, numAngles = 3, k = 3)"
"0","estXYk1 = predXY(newSignals = onlineSummary[ , 6:11], "
"0","                 newAngles = onlineSummary[ , 4], "
"0","                 offlineSummary, numAngles = 3, k = 1)"
"0","floorErrorMap = function(estXY, actualXY, trainPoints = NULL, AP = NULL){"
"0","  "
"0","    plot(0, 0, xlim = c(0, 35), ylim = c(-3, 15), type = ""n"","
"0","         xlab = """", ylab = """", axes = FALSE)"
"0","    box()"
"0","    if ( !is.null(AP) ) points(AP, pch = 15)"
"0","    if ( !is.null(trainPoints) )"
"0","      points(trainPoints, pch = 19, col=""grey"", cex = 0.6)"
"0","    "
"0","    points(x = actualXY[, 1], y = actualXY[, 2], "
"0","           pch = 19, cex = 0.8 )"
"0","    points(x = estXY[, 1], y = estXY[, 2], "
"0","           pch = 8, cex = 0.8 )"
"0","    segments(x0 = estXY[, 1], y0 = estXY[, 2],"
"0","             x1 = actualXY[, 1], y1 = actualXY[ , 2],"
"0","             lwd = 2, col = ""red"")"
"0","}"
"0","trainPoints = offlineSummary[ offlineSummary$angle == 0 & "
"0","                              offlineSummary$mac == ""00:0f:a3:39:e1:c0"" ,"
"0","                        c(""posX"", ""posY"")]"
"0","pdf(file=""GEO_FloorPlanK3Errors.pdf"", width = 10, height = 7)"
